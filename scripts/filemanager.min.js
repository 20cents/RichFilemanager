!function(a){function b(b,c){return k.indexOf(c)!==-1&&(("dir"!=b["File Type"]||"replace"!=c)&&(("dir"!=b["File Type"]||"select"!=c)&&("dir"==b["File Type"]&&"download"==c?g.security.allowFolderDownload===!0:"undefined"==typeof b.Capabilities||a.inArray(c,b.Capabilities)>-1)))}function c(c){var d={select:{name:z.select,className:"select"},download:{name:z.download,className:"download"},rename:{name:z.rename,className:"rename"},move:{name:z.move,className:"move"},replace:{name:z.replace,className:"replace"},separator1:"-----","delete":{name:z.del,className:"delete"}},e=c.data("itemdata");return b(e,"download")||delete d.download,b(e,"rename")&&g.options.browseOnly!==!0||delete d.rename,b(e,"delete")&&g.options.browseOnly!==!0||delete d["delete"],b(e,"move")&&g.options.browseOnly!==!0||delete d.move,b(e,"select")&&(window.opener||window.tinyMCEPopup||a.urlParam("field_name"))||delete d.select,delete d.replace,d}a.urlParam=function(a){var b=new RegExp("[\\?&]"+a+"=([^&#]*)").exec(window.location.href);return b?b[1]:0};var d=function(a){var b="",c="/",d=".",e=d.concat(d);if(!a||a===c)return c;var f,g,h,i=a.split(c),j=a[0]===c||a[0]===d?[b]:[];for(f=0,g=i.length;f<g;++f)h=i[f]||b,h===e?j.length>1&&j.pop():h!==b&&h!==d&&j.push(h);return j.join(c).replace(/[\/]{2, }/g,c)||c},e=function(b){var c=null,d=".";if(b="undefined"==typeof b?"user":b,window._FMConfig&&window._FMConfig.pluginPath&&(d=window._FMConfig.pluginPath),"user"==b)if(0!=a.urlParam("config")){var e=d+"/scripts/"+a.urlParam("config");userconfig=a.urlParam("config")}else{var e=d+"/scripts/filemanager.config.json";userconfig="filemanager.config.json"}else var e=d+"/scripts/filemanager.config.default.json";return a.ajax({async:!1,url:e,dataType:"json",cache:!1,success:function(a){c=a}}),"default"==b&&(c.globals={pluginPath:d}),c},f=e("default"),g=e();if(null!==g&&delete g.version,g=a.extend({},f,g),g.options.logger){(new Date).getTime()}var h=[],i="/",j=g.options.fileConnector||g.globals.pluginPath+"/connectors/"+g.options.lang+"/filemanager."+g.options.lang,k=g.options.capabilities||["upload","select","download","rename","move","delete","replace"],l=null,m={},n=[];g.options.fileSorting&&(n=g.options.fileSorting.toLowerCase().split("_"));var o=n[0]||"name",p=n[1]||"asc",q=function(b){if(b=g.globals.pluginPath+b,a.inArray(b,h)==-1){var c=a("<link rel='stylesheet' type='text/css' href='"+b+"'>");a("head").append(c),h.push(b)}},r=function(b){if(b=g.globals.pluginPath+b,a.inArray(b,h)==-1){var c=a("<script type='text/javascript' src='"+b+"'>");a("head").append(c),h.push(b)}},s=function(b,c){var d;return a.ajax({url:g.globals.pluginPath+"/scripts/templates/"+b+".html",async:!1,success:function(a){d=tmpl(a,c)}}),d},t=function(a){var b=this.window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest;if(!b)throw new Error("XMLHttpRequest not supported");return b.open("HEAD",a,!1),b.send(null),200==b.status},u=a("#fileinfo"),v=a("#filetree"),w=a("#uploader"),x=a("#upload");if(0!=a.urlParam("langCode"))if(t(g.globals.pluginPath+"/scripts/languages/"+a.urlParam("langCode")+".json"))g.options.culture=a.urlParam("langCode");else{var y=a.urlParam("langCode").substring(0,2);t(g.globals.pluginPath+"/scripts/languages/"+y+".json")&&(g.options.culture=y)}var z=[];a.ajax({url:g.globals.pluginPath+"/scripts/languages/"+g.options.culture+".json",async:!1,dataType:"json",success:function(a){z=a}}),a.prompt.setDefaults({overlayspeed:"fast",show:"fadeIn",opacity:.4,persistent:!1,classes:{box:"fm-modal-container",fade:"",prompt:"",close:"",title:"",message:"",buttons:"",button:"",defaultButton:""}});var A=function(){var b=0,c=a(".fm-container"),d=a("#splitter, #filetree, #fileinfo, .vsplitbar"),e=c.outerHeight(!0)-c.height();a.urlParam("CKEditorCleanUpFuncNum")&&(b+=60);var f=a(window).height()-w.height()-a("#footer").height()-e-b;d.height(f);var g=a(document).height()-a(window).height();if(!c.parent().is("body")&&g>0){var h=f-g;f=h>0?h:1,d.height(f)}var i=a("#splitter").width()-a("div.vsplitbar").width()-v.width();u.width(i)},B=function(a){setTimeout(function(){a.mCustomScrollbar("update")},0)},C=function(a,b){if(b="undefined"==typeof b,g.options.showFullPath===!1){if(a=a.replace(i,"/"),"function"==typeof displayPathDecorator)return displayPathDecorator(a);if(a.length>50&&b===!0){var c=a.split("/");a="/"+c[1]+"/"+c[2]+"/(...)/"+c[c.length-2]+"/"}return a}return a},D=function(a,b){var c,d=a.split("/"),e="/"+d[d.length-2]+"/",f=b.indexOf(e);return c=f==-1?a+b:a+b.substring(f+e.length),g.options.logger,c},E=function(b){"grid"==b?(a("#grid").addClass("ON"),a("#list").removeClass("ON")):(a("#list").addClass("ON"),a("#grid").removeClass("ON"))},F=function(a,b){if(g.security.normalizeFilename){var c={" ":"_","'":"_","/":"","\\":""};a=a.replace(/[\s\S]/g,function(a){return c[a]||a})}return g.options.charsLatinOnly&&(r("/scripts/speakingurl/speakingurl.min.js"),"undefined"==typeof b&&(b=[]),a=getSlug(a,{separator:"_",maintainCase:!0,custom:b}),a=a.replace(/[^_a-zA-Z0-9]/g,"")),a=a.replace(/[_]+/g,"_")},G=function(a){var b="";return a.lastIndexOf(".")!=-1?(b=F(a.substr(0,a.lastIndexOf("."))),b+="."+a.split(".").pop()):b=F(a),b},H=function(a,b){b=b||!1;for(var c=parseFloat(a),d=parseFloat(b?1e3:1024),e=0,f=[z.bytes,z.kb,z.mb,z.gb];;){if(c<d)return c=Math.round(100*c)/100,c+" "+f[e];c/=d,e+=1}},I=function(b){u.html("<h1>"+b+"</h1>"),a("#newfile").prop("disabled",!0),a("#newfolder").prop("disabled",!0),x.prop("disabled",!0)},J=function(b){a.prompt(z.ERROR_SERVER)},K=function(b){var c=N(b);return""==c&&1==g.security.allowNoExtension||("DISALLOW_ALL"==g.security.uploadPolicy&&a.inArray(c,g.security.uploadRestrictions)!=-1||"ALLOW_ALL"==g.security.uploadPolicy&&a.inArray(c,g.security.uploadRestrictions)==-1)},L=function(a){return"/"!=a.charAt(a.length-1)},M=function(a,b){var c=a.replace(/^.*[\/\\]/g,"");return"string"==typeof b&&c.substr(c.length-b.length)==b&&(c=c.substr(0,c.length-b.length)),c},N=function(a){return 1==a.split(".").length?"":a.split(".").pop().toLowerCase()},O=function(a){return a.lastIndexOf(".")!=-1?a.substring(0,a.lastIndexOf(".")):a},P=function(a){return a.lastIndexOf("/")!=a.length-1?a.substr(0,a.lastIndexOf("/")+1):a},Q=function(a){return a.split("/").reverse().slice(2).reverse().join("/")+"/"},R=function(a){return a.substring(0,a.slice(0,-1).lastIndexOf("/"))+"/"},S=function(b){return a.inArray(N(b),g.edit.editExt)!=-1},T=function(b){return a.inArray(N(b),g.images.imagesExt)!=-1},U=function(b){return a.inArray(N(b),g.videos.videosExt)!=-1},V=function(b){return a.inArray(N(b),g.audios.audiosExt)!=-1},W=function(b){return a.inArray(N(b),g.pdfs.pdfsExt)!=-1},X=function(b){return a.inArray(N(b),g.docs.docsExt)!=-1},Y=function(a){return"http"===a.substr(0,4)||"ftp"===a.substr(0,3)?a:location.origin+d(location.pathname+a)},Z=function(a){var b='<video src="'+Y(a.Preview)+'" width='+g.videos.videosPlayerWidth+" height="+g.videos.videosPlayerHeight+' controls="controls"></video>';u.find("img").remove(),u.find("#preview #main-title").before(b)},$=function(a){var b='<audio src="'+Y(a.Preview)+'" controls="controls"></audio>';u.find("img").remove(),u.find("#preview #main-title").before(b)},_=function(a){var b='<iframe id="fm-pdf-viewer" src="'+g.globals.pluginPath+"/scripts/ViewerJS/index.html#"+Y(a.Preview)+'" width="'+g.pdfs.pdfsReaderWidth+'" height="'+g.pdfs.pdfsReaderHeight+'" allowfullscreen webkitallowfullscreen></iframe>';u.find("img").remove(),u.find("#preview #main-title").before(b)},aa=function(a){var b=encodeURIComponent(Y(a.Preview)),c='<iframe id="fm-google-viewer" src="http://docs.google.com/viewer?url='+b+'&embedded=true" width="'+g.docs.docsReaderWidth+'" height="'+g.docs.docsReaderHeight+'" allowfullscreen webkitallowfullscreen></iframe>';u.find("img").remove(),u.find("#preview #main-title").before(c)},ba=function(b){u.find("tr.file, tr.directory").each(function(){var c=a(this).attr("data-path"),d=v.find('a[data-path="'+c+'"]').parent();"undefined"!=typeof d.css("background-image")&&(a(this).find("td:first").css("background-image",d.css("background-image")),window.clearInterval(b))})},ca=function(b){fa(b),a("#newfolder").unbind().click(function(){var b=z.default_foldername,c=z.prompt_foldername+' : <input id="fname" name="fname" type="text" value="'+b+'" />',d=function(c,d,e,f){if(d){var g=e.children("#fname").val();""!=g?(b=F(g),a.getJSON(j+"?mode=addfolder&path="+ea()+"&config="+userconfig+"&name="+encodeURIComponent(b)+"&time="+(new Date).getTime(),function(b){0==b.Code?(va(b.Parent),Na(b.Parent)):a.prompt(b.Error)})):a.prompt(z.no_foldername)}},e={};e[z.create_folder]=!0,e[z.cancel]=!1,a.prompt(c,{submit:d,buttons:e})})},da=function(c){u.find("button").each(function(b){0==a(this).find("span").length&&a(this).wrapInner("<span></span>")}),b(c,"select")?(u.find("button#select").click(function(){la(c)}).show(),(window.opener||window.tinyMCEPopup)&&a("#preview").find("img").attr("title",z.select).css("cursor","pointer").click(function(){la(c)})):u.find("button#select").hide(),b(c,"rename")?u.find("button#rename").click(function(){ma(c)}).show():u.find("button#rename").hide(),b(c,"move")?u.find("button#move").click(function(){oa(c)}).show():u.find("button#move").hide(),b(c,"replace")?u.find("button#replace").click(function(){na(c)}).show():u.find("button#replace").hide(),b(c,"delete")?u.find("button#delete").click(function(){qa(c)}).show():u.find("button#delete").hide(),b(c,"download")?u.find("button#download").click(function(){ra(c)}).show():u.find("button#download").hide(),u.find("#parentfolder").click(function(a){Na(ea())})},ea=function(){return a("#currentpath").val()},fa=function(b){a("#currentpath").val(b),w.find("h1").text(z.current_folder+C(b)).attr("title",C(b,!1))},ga=function(a){return a.find(".mCSB_container").length>0?a.find(".mCSB_container"):a},ha=function(a){return"grid"==u.data("view")?u.find('li[data-path="'+a+'"]'):u.find('tr[data-path="'+a+'"]')},ia=function(){var b,c="grid"==u.data("view"),d=c?"li":"tbody > tr",e=0;b=u.find(d+".file, "+d+".directory").not(".ui-draggable-dragging").length,u.find(d+".file").not(".ui-draggable-dragging").each(function(){var b=a(this).data("itemdata");e+=Number(b.Properties.Size)}),a("#items-counter").text(b+" "+z.items),a("#items-size").text(z.size+": "+H(e))},ja=function(b){1==g.options.searchBox&&(a("#q").liveUpdate("#filetree ul").blur(),a("#search span.q-inactive").html(z.search),a("#search a.q-reset").attr("title",z.search_reset)),b.find("li.file, li.directory").draggable({distance:10,cursor:"move",helper:function(){var b=a(this).clone();return b.find("ul").remove(),b}}),b.find("li.directory > a").droppable({accept:function(b){return b.is("li.file, li.directory")&&!b.parent().prev("a").is(a(this))},hoverClass:"drop-hover",drop:function(b,c){var d=c.draggable.find("a").attr("data-path"),e=a(b.target).attr("data-path");pa(d,e)}})},ka=function(){var b=ga(v),d=!1;b.data("fileTree")&&(d=!0,b.unbind().data("fileTree",null).children("ul.jqueryFileTree").remove());var e=function(a,b){d||(a.expandSpeed=b?300:0,a.collapseSpeed=b?300:0)},f=function(b,c){if(null!==l){var d=!1;b.find("li.directory.collapsed").each(function(b,f){var g=a(f).children();0===l.indexOf(g.attr("data-path"))&&(d=!0,e(c.options,!1),setTimeout(function(){g.click()},50))}),d===!1&&(l=null,e(c.options,!0))}};b.on("filetreeinitiated",function(b,c){var d=a(b.target).find("ul");f(d,c)}).on("filetreeexpand",function(a,b){Na(b.rel)}).on("filetreeexpanded",function(a,b){var c=b.li.children("ul");f(c,b),l==b.rel&&(l=null,e(b.options,!0))}).fileTree({root:i,script:Pa,multiFolder:!0,expandSpeed:300,collapseSpeed:300,errorMessage:null},function(a){La(a)}),b.contextMenu({selector:"li a",build:function(a,b){return{appendTo:".fm-container",items:c(a),callback:function(a,b){var c=b.$trigger.attr("data-path");Ka(a,c)}}}})},la=function(b){if(g.options.baseUrl!==!1)var c=D(baseUrl,b.Preview.replace(i,""));else var c=Y(b.Preview);if(window.opener||window.tinyMCEPopup||a.urlParam("field_name")||a.urlParam("CKEditorCleanUpFuncNum")||a.urlParam("CKEditor")||a.urlParam("ImperaviElementId")){if(window.tinyMCEPopup){var d=tinyMCEPopup.getWindowArg("window");return d.document.getElementById(tinyMCEPopup.getWindowArg("input")).value=c,"undefined"!=typeof d.ImageDialog&&(d.ImageDialog.getImageData&&d.ImageDialog.getImageData(),d.ImageDialog.showPreviewImage&&d.ImageDialog.showPreviewImage(c)),void tinyMCEPopup.close()}if(a.urlParam("field_name"))parent.document.getElementById(a.urlParam("field_name")).value=c,"undefined"!=typeof parent.tinyMCE&&parent.tinyMCE.activeEditor.windowManager.close(),"undefined"!=typeof parent.$.fn.colorbox&&parent.$.fn.colorbox.close();else if(a.urlParam("ImperaviElementId"))if(window.opener);else{var e=a.urlParam("ImperaviElementId"),f=parent.$("#"+e).redactor("core.getObject");f&&(f.modal.close(),f.buffer.set(),T(b.Filename)?f.insert.html('<img src="'+c+'">'):f.insert.html('<a href="'+c+'">'+b.Filename+"</a>"))}else if(a.urlParam("CKEditor"))window.opener?window.opener.CKEDITOR.tools.callFunction(a.urlParam("CKEditorFuncNum"),c):(parent.CKEDITOR.tools.callFunction(a.urlParam("CKEditorFuncNum"),c),parent.CKEDITOR.tools.callFunction(a.urlParam("CKEditorCleanUpFuncNum")));else if(""!=b.Properties.Width){var h=c,j=b.Properties.Width,k=b.Properties.Height;window.opener.SetUrl(h,j,k)}else window.opener.SetUrl(c);window.opener&&window.close()}else a.prompt(z.fck_select_integration)},ma=function(b){var c=g.security.allowChangeExtensions?b.Filename:O(b.Filename),d=z.new_filename+' : <input id="rname" name="rname" type="text" value="'+c+'" />',e=function(c,d,e,f){if(d){var h=e.children("#rname").val();if(""!=h){var i=h;if(!g.security.allowChangeExtensions){i=G(h);var k=N(b.Filename);k.length>0&&(i=i+"."+k)}if(L(b.Path)&&!K(i)){var l="<p>"+z.INVALID_FILE_TYPE+"</p>";return"DISALLOW_ALL"==g.security.uploadPolicy&&(l+="<p>"+z.ALLOWED_FILE_TYPE+g.security.uploadRestrictions.join(", ")+".</p>"),"ALLOW_ALL"==g.security.uploadPolicy&&(l+="<p>"+z.DISALLOWED_FILE_TYPE+g.security.uploadRestrictions.join(", ")+".</p>"),a("#filepath").val(""),a.prompt(l),!1}var m=j+"?mode=rename&old="+encodeURIComponent(b.Path)+"&new="+encodeURIComponent(i)+"&config="+userconfig;a.ajax({type:"GET",url:m,dataType:"json",async:!1,success:function(b){if(0==b.Code){var c=b["New Path"],d=b["New Name"],e=b["Old Path"],f=P(c),h=P(e),i=ea(),j=u.find("#main-title > h1"),k=j.length>0;if(wa(e,c,d),0===f.indexOf(i))if(L(c)&&N(c)!==N(e)){var l=k?c:f;Ja(l)}else k&&e===j.attr("title")?za(c):k||Aa(ha(e),c,d);else if(0===i.indexOf(h)){var m=new RegExp("^"+h),n=ea().replace(m,f);if(fa(n),k)za(n);else{var o="grid"==u.data("view")?"li":"tbody > tr";Ca(e,c,u.find(o))}}Ga(),ia(),g.options.showConfirmation&&a.prompt(z.successful_rename)}else a.prompt(b.Error)},error:J})}}},f={};f[z.rename]=!0,f[z.cancel]=!1,a.prompt(d,{submit:e,buttons:f})},na=function(b){var c=a("#toolbar"),d=c.find("#replacement");"undefined"==typeof c.data("blueimpFileupload")&&c.fileupload({autoUpload:!0,dataType:"json",url:j+"?config="+userconfig,paramName:g.upload.paramName}).on("fileuploadadd",function(c,d){var e=d.files[0];return N(e.name)!=b["File Type"]?(a.prompt(z.ERROR_REPLACING_FILE+" ."+b["File Type"]),!1):void d.submit()}).on("fileuploadsubmit",function(a,c){c.formData={mode:"replace",newfilepath:b.Path},x.addClass("loading").prop("disabled",!0),x.children("span").text(z.loading_data)}).on("fileuploadalways",function(b,c){x.removeData().removeClass("loading").prop("disabled",!1),x.children("span").text(z.upload);var d,e=c.result;if(e.files&&e.files[0].error&&(d=e.files[0].error),"-1"==e.Code&&e.Error&&(d=e.Error),d)a.prompt(z.upload_failed+"<br>"+d);else{var f=u.find("#main-title > h1").attr("title"),h=ea();La(f),Ia(h),a("#preview").find("img").hide().fadeIn("slow"),v.find('a[data-path="'+f+'"]').parent().hide().fadeIn("slow"),g.options.showConfirmation&&a.prompt(z.successful_replace)}}).on("fileuploadfail",function(b,c){a.prompt(z.upload_failed)}),d.click()},oa=function(b){var c=z.move+' : <input id="rname" name="rname" type="text" value="" />';c+='<div class="prompt-info">'+z.help_move+"</div>";var d=function(a,c,d,e){if(c){var f=d.children("#rname").val();""!=f&&pa(b.Path,f)}},e={};e[z.move]=!0,e[z.cancel]=!1,a.prompt(c,{submit:d,buttons:e})},pa=function(b,c){var d=j+"?mode=move&old="+encodeURIComponent(b)+"&new="+encodeURIComponent(c)+"&config="+userconfig;a.ajax({type:"GET",url:d,dataType:"json",async:!1,success:function(c){if(0==c.Code){var d=c["New Path"],e=c["New Name"],f=ea();if(xa(d,e,b),f===d&&Na(d),f===P(b)){var h=L(b)?d:d+e+"/";if(f===b&&fa(h),a("#preview").length>0)za(h);else{var i="grid"==u.data("view")?"li":"tbody > tr";Ca(b,h,u.find(i))}Ga(),ia()}g.options.showConfirmation&&a.prompt(z.successful_moved)}else a.prompt(c.Error)},error:J})},qa=function(b){var c=!1,d=z.confirmation_delete,e=function(d,e,f,h){if(e){var i=j+"?mode=delete&path="+encodeURIComponent(b.Path)+"&config="+userconfig+"&time="+(new Date).getTime();a.ajax({type:"GET",url:i,dataType:"json",async:!1,success:function(b){if(0==b.Code){var d=b.Path,e=u.find("#main-title > h1"),f=e.length>0;if(ya(d),c=!0,d===ea()){var h=R(d);fa(h),Ja(h)}else L(d)&&f&&d===e.attr("title")&&Ja(P(d));g.options.showConfirmation&&a.prompt(z.successful_delete)}else c=!1,a.prompt(b.Error)},error:J})}},f={};return f[z.yes]=!0,f[z.no]=!1,a.prompt(d,{submit:e,buttons:f}),c},ra=function(b){var c=j+"?mode=download&path="+encodeURIComponent(b.Path)+"&config="+userconfig;a.ajax({type:"GET",url:c+"&time="+(new Date).getTime(),dataType:"json",async:!1,success:function(b){0==b.Code?window.location=c+"&force=true&time="+(new Date).getTime():a.prompt(b.Error)},error:J})},sa=function(b){var c=!1;return u.find("div#tools").append(' <a id="edit-file" href="#" title="'+z.edit+'"><span>'+z.edit+"</span></a>"),a("#edit-file").click(function(){a(this).hide();var d=j+"?mode=editfile&path="+encodeURIComponent(b.Path)+"&config="+userconfig+"&time="+(new Date).getTime();a.ajax({type:"GET",url:d,dataType:"json",async:!1,success:function(d){if(0==d.Code){var e,f=a("#preview"),h='<form id="edit-form">';h+='<textarea id="edit-content" name="content">'+d.Content+"</textarea>",h+='<input type="hidden" name="mode" value="savefile" />',h+='<input type="hidden" name="path" value="'+b.Path+'" />',h+='<button id="edit-cancel" class="edition" type="button">'+z.quit_editor+"</button>",h+='<button id="edit-save" class="edition" type="button">'+z.save+"</button>",h+="</form>",f.find("img").hide(),f.prepend(h).hide().fadeIn(),B(u),a("#edit-cancel").click(function(){f.find("form#edit-form").hide(),f.find("img").fadeIn(),a("#edit-file").show()}),a("#edit-save").click(function(){var b=e.getValue();a("textarea#edit-content").val(b);var d=a("#edit-form").serializeArray();a.ajax({type:"POST",url:j+"?config="+userconfig,dataType:"json",data:d,async:!1,success:function(b){0==b.Code?(c=!0,a.prompt(z.successful_edit)):(c=!1,a.prompt(b.Error))},error:J})}),e=instantiateCodeMirror(N(b.Path),g,r)}else c=!1,a.prompt(d.Error),a(this).show()}})}),c},ta=function(b,c){c=c||0,ha(b).not(".directory-parent").fadeOut(c,function(){a(this).remove(),ia()})},ua=function(b,c){c=c||0,v.find('a[data-path="'+b+'"]').parent().fadeOut(c,function(){a(this).remove()})},va=function(b){Ia(b),g.options.showConfirmation&&a.prompt(z.successful_added_folder)},wa=function(a,b,c){var d=v.find('a[data-path="'+a+'"]');L(b)?N(b)!==N(a)?Ha(P(b),a,b):Ba(d,b,c):(Ba(d,b,c),Ca(a,b,d.next("ul").find("a"))),Fa(v.find('a[data-path="'+b+'"]').parent().parent())},xa=function(a,b,c,d){d=d||!1;var e=ea(),f=v.find('a[data-path="'+a+'"]'),g=f.next("ul"),h=g.parent();if(ta(c),d&&(l=a,ka()),a===i&&(g=ga(v).children("ul"),h=v),0===g.length)return e===c&&(ga(v).data("fileTree").options.expandSpeed=0,f.click()),void ua(c);e===a&&(g.is(":hidden")&&g.show().parent().addClass("expanded").removeClass("collapsed"),Na(a));var j=v.find('a[data-path="'+c+'"]').parent().not(".ui-draggable-dragging");Ca(R(c),a,j.find("a")),j.appendTo(g),Fa(g),ja(h)},ya=function(a){ta(a),ua(a)},za=function(b){var c=a("#toolbar"),d=u.find("#main-title > h1"),e=M(b)||d.text(),f=P(b)+e;d.text(e).attr("title",f);var g=c.data("fmitem");g.Path=f,g.Filename=e,c.find("button").unbind(),da(g)},Aa=function(a,b,c){var d=a.data("itemdata");d.Path=b,"undefined"!=typeof c&&(d.Filename=c,L(c)&&(d["File Type"]=N(c))),a.attr("data-path",b),"grid"==u.data("view")?(a.find("img").attr("alt",b),a.children("p").text(d.Filename)):a.find("td:first").text(d.Filename)},Ba=function(a,b,c){var d=a.data("itemdata");d.Path=b,"undefined"!=typeof c&&(d.Filename=c,L(c)&&(d["File Type"]=N(c))),a.attr("data-path",b).attr("rel",b),a.text(d.Filename)},Ca=function(b,c,d){var e=new RegExp("^"+b);d.each(function(){var b=a(this).attr("data-path"),d=b.replace(e,c);a(this).is("a")?Ba(a(this),d):a(this).hasClass("directory-parent")?a(this).attr("data-path",Q(ea())):Aa(a(this),d)})},Da=function(b){var c=o,d=a(b).data("itemdata");if("list"==u.data("view")){var e=u.data("list-sort");e&&(c=e.column)}switch(c){case"type":return d["File Type"];case"size":return d.Properties.Size;case"modified":return d.Properties.filemtime;case"dimensions":return d.Properties.Width+"x"+d.Properties.Height;default:return d.Filename}},Ea=function(a,b){"bottom"===g.options.folderPosition&&a.find(b+".directory").appendTo(a),"top"===g.options.folderPosition&&(a.find(b+".directory").prependTo(a),a.find(b+".directory-parent").prependTo(a))},Fa=function(a){var b=a.find("> li");0!==b.length&&(b.tsort({selector:"a",callback:Da,order:p,natural:!0}),Ea(a,"> li"))},Ga=function(){var a,b=u.find("#contents");if("grid"==u.data("view")){if(a=b.find("li.file, li.directory"),0===a.length)return;a.tsort({callback:Da,order:p,natural:!0}),Ea(b,"li")}else{var c,d,e,f=u.data("list-sort"),g=b.find("th");if(d=f?f.order:p,c=f?f.column:o,e=g.filter(".column-"+c),g.removeClass("sorted sorted-asc sorted-desc"),e.addClass("sorted sorted-"+d),a=b.find("tr.file, tr.directory"),0===a.length)return;a.tsort({callback:Da,order:d,natural:!0}),Ea(b,"tr")}},Ha=function(a,b,c){var d=v.find('a[data-path="'+b+'"]').parent(),e=Pa({dir:P(a)},c);d.replaceWith(e)},Ia=function(b){var c,d=b===i;if(c=d?ga(v).children("ul"):v.find('a[data-path="'+b+'"]').next("ul"),d||c.parent().hasClass("expanded")){var e=Pa({dir:b}),f=c.find(">li>a").map(function(){return this.getAttribute("data-path")}).get();e.find(">li>a").each(function(){f.indexOf(a(this).attr("data-path"))===-1&&c.append(a(this).parent())}),Fa(c),ja(c)}else ga(v).data("fileTree").options.expandSpeed=0,c.prev("a").click()},Ja=function(a){if(L(a))La(a);else{Na(a);var b=v.find('a[data-path="'+a+'"]');b.parent().hasClass("collapsed")&&b.click()}},Ka=function(b,c){a.getJSON(j+"?mode=getinfo&path="+encodeURIComponent(c)+"&config="+userconfig+"&time="+(new Date).getTime(),function(a){switch(b){case"select":la(a);break;case"download":ra(a);break;case"rename":ma(a);break;case"replace":na(a);break;case"move":oa(a);break;case"delete":qa(a)}})},La=function(b){a(".context-menu-root").hide();var c=b.substr(0,b.lastIndexOf("/")+1);ca(c),a.getJSON(j+"?mode=getinfo&path="+encodeURIComponent(b)+"&config="+userconfig+"&time="+(new Date).getTime(),function(c){if("-1"==c.Code)return void I(c.Error);var d='<div id="preview"><img /><div id="main-title"><h1></h1><div id="tools"></div></div><dl></dl></div>';if(d+='<form id="toolbar">',d+='<button id="parentfolder" type="button">'+z.parentfolder+"</button>",a.inArray("select",k)!=-1&&(a.urlParam("CKEditor")||window.opener||window.tinyMCEPopup||a.urlParam("field_name")||a.urlParam("ImperaviElementId"))&&(d+='<button id="select" name="select" type="button">'+z.select+"</button>"),a.inArray("download",k)!=-1&&(d+='<button id="download" name="download" type="button">'+z.download+"</button>"),a.inArray("rename",k)!=-1&&1!=g.options.browseOnly&&(d+='<button id="rename" name="rename" type="button">'+z.rename+"</button>"),a.inArray("move",k)!=-1&&1!=g.options.browseOnly&&(d+='<button id="move" name="move" type="button">'+z.move+"</button>"),a.inArray("delete",k)!=-1&&1!=g.options.browseOnly&&(d+='<button id="delete" name="delete" type="button">'+z.del+"</button>"),a.inArray("replace",k)!=-1&&1!=g.options.browseOnly&&(d+='<button id="replace" name="replace" type="button">'+z.replace+"</button>",d+='<div class="hidden-file-input"><input id="replacement" name="replacement" type="file" /></div>'),d+="</form>",ga(u).html(d),u.find("#main-title > h1").text(c.Filename).attr("title",b),u.find("img").attr("src",c.Preview?Y(c.Preview):c.Thumbnail),U(c.Filename)&&1==g.videos.showVideoPlayer&&Z(c),V(c.Filename)&&1==g.audios.showAudioPlayer&&$(c),W(c.Filename)&&1==g.pdfs.showPdfReader&&_(c),X(c.Filename)&&1==g.docs.showGoogleViewer&&aa(c),S(c.Filename)&&1==g.edit.enabled&&0==c.Protected&&sa(c),g.options.baseUrl!==!1)var e=D(baseUrl,c.Preview.replace(i,""));else var e=Y(c.Preview);if(0==c.Protected){u.find("div#tools").append(' <a id="copy-button" data-clipboard-text="'+e+'" title="'+z.copy_to_clipboard+'" href="#"><span>'+z.copy_to_clipboard+"</span></a>"),ZeroClipboard.config({swfPath:g.globals.pluginPath+"/scripts/zeroclipboard/dist/ZeroClipboard.swf"});var f=new ZeroClipboard(document.getElementById("copy-button"));f.on("ready",function(a){f.on("aftercopy",function(a){})}),a("#copy-button").click(function(){u.find("div#tools").append('<span id="copied">'+z.copied+"</span>"),a("#copied").delay(500).fadeOut(1e3,function(){a(this).remove()})})}var h="";0==c.Protected&&(c.Properties.Width&&""!=c.Properties.Width&&(h+="<dt>"+z.dimensions+"</dt><dd>"+c.Properties.Width+"x"+c.Properties.Height+"</dd>"),c.Properties["Date Created"]&&""!=c.Properties["Date Created"]&&(h+="<dt>"+z.created+"</dt><dd>"+c.Properties["Date Created"]+"</dd>"),c.Properties["Date Modified"]&&""!=c.Properties["Date Modified"]&&(h+="<dt>"+z.modified+"</dt><dd>"+c.Properties["Date Modified"]+"</dd>"),(c.Properties.Size||0==parseInt(c.Properties.Size))&&(h+="<dt>"+z.size+"</dt><dd>"+H(c.Properties.Size)+"</dd>")),u.find("dl").html(h),a("#toolbar").data("fmitem",c),da(c)})},Ma=function(b){var c=a.extend({},b);return delete c.Thumbnail,delete c.Error,delete c.Code,c},Na=function(d){ca(d);var e,f,h,j,k=ga(u),l='<img id="activity" src="'+g.globals.pluginPath+"/themes/"+g.options.theme+'/images/wait30trans.gif" width="30" height="30" />';k.html(l),a("#loading-wrap").fadeOut(800);var m="",n=Oa(d);if("-1"==n.Code)return void I(n.Error);if(A(),n)if("grid"==u.data("view")){var o=a("<ul>",{id:"contents","class":"grid"});L(d)||d===i||(h='<li class="directory-parent" data-path="'+Q(d)+'" oncontextmenu="return false;">',h+='<div class="clip"><img src="'+g.globals.pluginPath+"/"+g.icons.path+'/_Parent.png" alt="Parent" /></div>',h+="</li>",o.append(h));for(var p in n){e=n[p],j=e.Properties;var q=64,r=j.Width;r>1&&r<q&&(q=r);var s=a("<li>",{"class":"dir"==e["File Type"]?"directory":"file",title:g.options.showTitleAttr?e.Path:null,"data-path":e.Path}).data("itemdata",Ma(e));f='<div class="clip"><img src="'+e.Thumbnail+'" width="'+q+'" alt="'+e.Path+'" /></div>',f+="<p>"+e.Filename+"</p>",j.Width&&""!=j.Width&&(f+='<span class="meta dimensions">'+j.Width+"x"+j.Height+"</span>"),j.Size&&""!=j.Size&&(f+='<span class="meta size">'+j.Size+"</span>"),j["Date Created"]&&""!=j["Date Created"]&&(f+='<span class="meta created">'+j["Date Created"]+"</span>"),j["Date Modified"]&&""!=j["Date Modified"]&&(f+='<span class="meta modified">'+j["Date Modified"]+"</span>"),o.append(s.append(f))}m=o}else{var t=a("<table>",{id:"contents","class":"list"}),v='<thead><tr class="rowHeader">';v+='<th class="column-name" data-colname="name"><span>'+z.name+"</span></th>",v+='<th class="column-type" data-colname="type"><span>'+z.type+"</span></th>",v+='<th class="column-dimensions" data-colname="dimensions"><span>'+z.dimensions+"</span></th>",v+='<th class="column-size" data-colname="size"><span>'+z.size+"</span></th>",v+='<th class="column-modified" data-colname="modified"><span>'+z.modified+"</span></th>",v+="</tr></thead>",t.append(v),t.append("<tbody>"),L(d)||d===i||(h='<tr class="directory-parent" data-path="'+Q(d)+'" oncontextmenu="return false;">',h+="<td>..</td>",h+="<td></td>",h+="<td></td>",h+="<td></td>",h+="<td></td>",h+="</tr>",t.append(h));for(var p in n){e=n[p],j=e.Properties;var w=a("<tr>",{"class":"dir"==e["File Type"]?"directory":"file",title:g.options.showTitleAttr?e.Path:null,"data-path":e.Path}).data("itemdata",Ma(e));if(f="<td>"+e.Filename+"</td>",f+=e["File Type"]&&""!=e["File Type"]&&"dir"!=e["File Type"]?"<td>"+e["File Type"]+"</td>":"<td></td>",j.Width&&""!=j.Width){var x=j.Width+"x"+j.Height;f+="<td>"+x+"</td>"}else f+="<td></td>";f+=j.Size&&""!=j.Size?"<td>"+H(j.Size)+"</td>":"<td></td>",f+=j["Date Modified"]&&""!=j["Date Modified"]?"<td>"+j["Date Modified"]+"</td>":"<td></td>",t.append(w.append(f))}t.append("</tbody>"),m=t}else m+="<h1>"+z.could_not_retrieve_folder+"</h1>";k.html(m),Ga(),ia();var y=u.find("#contents");if("grid"==u.data("view"))y.contextMenu({selector:"li.file, li.directory",build:function(a,b){return{appendTo:".fm-container",items:c(a),callback:function(a,b){var c=b.$trigger.attr("data-path");Ka(a,c)}}}}),y.find("li.file, li.directory").draggable({distance:10,cursor:"move",helper:"clone"}),y.find("li.directory-parent, li.directory").droppable({accept:"li.file, li.directory",hoverClass:"drop-hover",drop:function(b,c){var d=c.draggable.attr("data-path"),e=a(b.target).attr("data-path");pa(d,e)}}),y.find("li").click(function(){var c=a(this).attr("data-path");g.options.quickSelect&&"dir"!=n[c]["File Type"]&&b(n[c],"select")?la(n[c]):Ja(c)});else{y.contextMenu({selector:"tr.file, tr.directory",build:function(a,b){return{appendTo:".fm-container",items:c(a),callback:function(a,b){var c=b.$trigger.attr("data-path");Ka(a,c)}}}}),y.find("tr.file, tr.directory").draggable({distance:10,cursor:"move",helper:"clone"}),y.find("tr.directory-parent, tr.directory").droppable({accept:"tr.file, tr.directory",hoverClass:"drop-hover",drop:function(b,c){var d=c.draggable.attr("data-path"),e=a(b.target).attr("data-path");pa(d,e)}}),y.find("tbody > tr").click(function(){var c=a(this).attr("data-path");g.options.quickSelect&&"dir"!=n[c]["File Type"]&&b(n[c],"select")?la(n[c]):Ja(c)}),y.find(".rowHeader > th").click(function(b){var c=a(this),d=c.data("colname"),e=!c.hasClass("sorted-desc"),f=e?"desc":"asc";u.data("list-sort",{column:d,order:f}),Ga()});var B=setInterval(function(){ba(B)},300)}},Oa=function(b){if(!m[b]||Date.now()-m[b].cached>2e3){var c=j+"?mode=getfolder&path="+encodeURIComponent(b)+"&config="+userconfig+"&showThumbs="+g.options.showThumbs+"&time="+(new Date).getTime();a.urlParam("type")&&(c+="&type="+a.urlParam("type")),a.ajax({async:!1,url:c,dataType:"json",cache:!1,success:function(a){m[b]={cached:Date.now(),data:a}},error:J})}return m[b].data},Pa=function(b,c){var d,e=[],f=Oa(b.dir);if("-1"==f.Code)return void I(f.Error);if(f){for(var g in f){var h=Qa(f[g]);if(c&&f[g].Path===c)return h;e.push(h)}var i=a("<ul>",{"class":"jqueryFileTree",style:"display: none;"}).append(e);Fa(i),ja(i),d=i}else d=a("<h1>").text(z.could_not_retrieve_folder);return d},Qa=function(b){var c,d,e=a("<a>",{rel:b.Path,"data-path":b.Path,text:b.Filename}).data("itemdata",Ma(b));return"dir"==b["File Type"]?(d=0==b.Protected?"":" directory-locked",c=a("<li>",{"class":"directory collapsed"+d}).append(e)):g.options.listFiles&&(d=0==b.Protected?"":" file-locked",c=a("<li>",{"class":"file ext_"+b["File Type"].toLowerCase()+d}).append(e)),c};a(function(){if(g.extras.extra_js)for(var b=0;b<g.extras.extra_js.length;b++)a.ajax({url:g.extras.extra_js[b],dataType:"script",async:g.extras.extra_js_async});a("#link-to-project").attr("href",g.url).attr("target","_blank").attr("title",z.support_fm+" ["+z.version+" : "+g.version+"]"),a("div.version").html(g.version),q("/themes/"+g.options.theme+"/styles/filemanager.css"),a.ajax({url:g.globals.pluginPath+"/themes/"+g.options.theme+"/styles/ie.css",async:!1,success:function(b){a("head").append(b)}}),r("/scripts/zeroclipboard/dist/ZeroClipboard.js"),g.edit.enabled&&(q("/scripts/CodeMirror/lib/codemirror.css"),
q("/scripts/CodeMirror/theme/"+g.edit.theme+".css"),r("/scripts/CodeMirror/lib/codemirror.js"),r("/scripts/CodeMirror/addon/selection/active-line.js"),q("/scripts/CodeMirror/addon/display/fullscreen.css"),r("/scripts/CodeMirror/addon/display/fullscreen.js"),r("/scripts/CodeMirror/dynamic-mode.js")),g.options.baseUrl===!1?baseUrl=window.location.protocol+"//"+window.location.host:baseUrl=g.options.baseUrl,0!=a.urlParam("exclusiveFolder")&&(i+=a.urlParam("exclusiveFolder"),L(i)&&(i+="/"),i=i.replace(/\/\//g,"/"));var c="";if(0!=a.urlParam("expandedFolder")&&(c=a.urlParam("expandedFolder"),l=i+c),g.options.localizeGUI===!0&&(x.append(z.upload),a("#newfolder").append(z.new_folder),a("#grid").attr("title",z.grid_view),a("#list").attr("title",z.list_view)),a.urlParam("CKEditorCleanUpFuncNum")&&(a("body").append('<button id="close-btn" type="button">'+z.close+"</button>"),a("#close-btn").click(function(){parent.CKEDITOR.tools.callFunction(a.urlParam("CKEditorCleanUpFuncNum"))})),a("#browse").append("+").attr("title",z.browse),a("#newfile").change(function(){a("#filepath").val(a(this).val().replace(/.+[\\\/]/,""))}),g.options.searchBox===!0?r("/scripts/filemanager.liveSearch.min.js"):a("#search").remove(),a("button").wrapInner("<span></span>"),u.data("view",g.options.defaultViewMode),E(g.options.defaultViewMode),a("#home").click(function(){ka(),Na(i)}),a("#level-up").click(function(){var b=ea(),c=a("#preview").length>0;if(b==i&&!c)return!1;var d=c?b:Q(b);Na(d)}),a("#grid").click(function(){E("grid"),u.data("view","grid"),Na(ea())}),a("#list").click(function(){E("list"),u.data("view","list"),Na(ea())}),a("#summary").click(function(){var b='<div class="title">'+z.summary_title+"</div>",c=a.prompt(b).addClass("summary-popup");a.getJSON(j+"?mode=summarize&config="+userconfig,function(b){if(0==b.Code){var d=c.find(".jqimessage"),e=H(b.Size,!0);if(g.options.fileRootSizeLimit>0){var f=H(g.options.fileRootSizeLimit,!0),h=100*b.Size/g.options.fileRootSizeLimit,i=Math.round(100*h)/100;e+=" ("+i+"%) "+z.of+" "+f}d.append(a("<div>",{"class":"line",text:z.summary_files+": "+b.Files})),b.Folders&&d.append(a("<div>",{"class":"line",text:z.summary_folders+": "+b.Folders})),d.append(a("<div>",{"class":"line",text:z.summary_size+": "+e}))}else a.prompt(b.Error)})}),ca(i),g.upload.multiple?(q("/scripts/jQuery-File-Upload/css/dropzone.css"),a("#file-input-container").remove(),x.unbind().click(function(){if(k.indexOf("upload")===-1)return a.prompt(z.NOT_ALLOWED),!1;var b,c=ea(),d=s("upload-container",{folder:z.current_folder+c,info:z.upload_files_number_limit.replace("%s",g.upload.numberOfFiles)+" "+z.upload_file_size_limit+H(g.upload.fileSizeLimit,!0),lang:z});b="DISALLOW_ALL"==g.security.uploadPolicy?new RegExp("(\\.|\\/)("+g.security.uploadRestrictions.join("|")+")$","i"):null,("images"==a.urlParam("type").toString().toLowerCase()||g.upload.imagesOnly)&&(b=new RegExp("(\\.|\\/)("+g.images.imagesExt.join("|")+")$","i"));var e={};e[z.close]=!1,a.prompt(d,{buttons:e,persistent:!0});var f=a("#fileupload-container"),h=a(".dropzone",f),i=a("#total-progress",f).children();h.on("click",function(b){(b.target===this||a(b.target).parent().hasClass("default-message"))&&a("#fileupload",f).trigger("click")}),h.on("click",".button-start",function(b){var c=a(this),d=c.parent().parent(),e=d.data();e.submit(),c.remove()}),h.on("click",".button-abort",function(b){var c=a(this),d=c.parent().parent(),e=d.data(),f=e.files[0].context;e.abort(),f.find(".error-message").text(z.upload_aborted),f.addClass("aborted")}),h.on("click",".button-resume",function(b){var d=a(this),e=d.parent().parent(),f=e.data(),g=f.files[0];if(g.chunkUploaded){var h=c+g.serverName,i=j+"?mode=getinfo&path="+encodeURIComponent(h)+"&config="+userconfig+"&time="+(new Date).getTime();a.ajax({url:i,dataType:"json",async:!1,success:function(a){0==a.Code&&(f.uploadedBytes=Number(a.Properties.Size),f.uploadedBytes||(g.chunkUploaded=void 0))}})}a.blueimp.fileupload.prototype.options.add.call(a("#fileupload")[0],b,f),f.submit()}),h.on("click",".button-remove",function(b){var d=a(this),e=d.parent().parent(),f=e.data(),g=f.files[0];if(g.chunkUploaded){var h=c+g.serverName,i=j+"?mode=delete&path="+encodeURIComponent(h)+"&config="+userconfig+"&time="+(new Date).getTime();a.getJSON(i,function(a){if(0==a.Code){var b=a.Path;ya(b)}})}d.closest(".upload-item").remove(),l()}),h.on("click",".button-info",function(b){var c=a(this),d=c.closest(".upload-item");if(d.hasClass("error")){var e=d.find(".error-message");e.css({opacity:"1"===e.css("opacity")?"0":"1"})}}),a("#process-upload",f).on("click",function(){h.find(".button-start").trigger("click")});var l=function(){h.children(".upload-item").length>0?h.addClass("started"):h.removeClass("started")};a("#fileupload",f).fileupload({autoUpload:!1,sequentialUploads:!0,dataType:"json",dropZone:h,maxChunkSize:g.upload.chunkSize,url:j+"?config="+userconfig,paramName:g.upload.paramName,formData:{mode:"add",currentpath:c},maxNumberOfFiles:g.upload.numberOfFiles,acceptFileTypes:b,maxFileSize:g.upload.fileSizeLimit,messages:{maxNumberOfFiles:z.upload_files_number_limit.replace("%s",g.upload.numberOfFiles),acceptFileTypes:z.upload_file_type_invalid,maxFileSize:z.upload_file_too_big+" "+z.upload_file_size_limit+H(g.upload.fileSizeLimit,!0)},previewMaxHeight:120,previewMaxWidth:120,previewCrop:!0}).on("fileuploadadd",function(b,c){var d=h.children(".upload-item");a.each(c.files,function(b,e){if(d.length>=g.upload.numberOfFiles)return!1;e.formattedSize=H(e.size);var f=a(s("upload-item",{file:e,lang:z,imagesPath:g.globals.pluginPath+"/scripts/jQuery-File-Upload/img"}));e.context=f,f.find(".buttons").data(c),f.appendTo(h)}),l()}).on("fileuploadsend",function(b,c){a.each(c.files,function(a,b){var d=b.context;d.removeClass("added aborted error").addClass("process"),b.chunkUploaded&&c.total===c.uploadedBytes&&d.remove()})}).on("fileuploadfail",function(b,c){a.each(c.files,function(a,b){b.error=z.upload_failed;var c=b.context;c.removeClass("added process").addClass("error")})}).on("fileuploaddone",function(b,c){a.each(c.files,function(a,b){var d,e=c.result,f=b.context;e.files&&e.files[a].error&&(d=e.files[a].error),"-1"==e.Code&&e.Error&&(d=e.Error),d?(f.removeClass("added process").addClass("error"),f.find(".error-message").text(d),f.find(".button-start").remove()):f.remove()})}).on("fileuploadalways",function(b,d){var e=h.children(".upload-item");0===e.filter(".added").length&&0===e.filter(".process").length&&(0===e.length&&(a.prompt.close(),g.options.showConfirmation&&a.prompt(z.upload_successful_files)),e.filter(".error").length&&a.prompt(z.upload_partially+"<br>"+z.upload_failed_details),Na(c),Ia(c)),l()}).on("fileuploadprocessalways",function(b,c){a.each(c.files,function(a,b){var c=b.context;b.preview&&(c.find(".image").append(b.preview),c.find(".preview").removeClass("file-preview").addClass("image-preview")),b.error&&(c.removeClass("added process").addClass("error"),c.find(".error-message").text(b.error),c.find(".button-start").remove())})}).on("fileuploadprogress",function(b,c){a.each(c.files,function(a,b){var d=b.context,e=parseInt(c.loaded/c.total*100,10);d.find(".progress-bar").css("width",e+"%")})}).on("fileuploadprogressall",function(a,b){var c=parseInt(b.loaded/b.total*100,10);i.css("width",c+"%")}).on("fileuploadchunkdone",function(b,c){a.each(c.files,function(a,b){b.serverName=c.result.files[a].name,b.chunkUploaded=1})})})):(x.click(function(){if(k.indexOf("upload")===-1)return a.prompt(z.NOT_ALLOWED),!1;var b=a(this).data();a.isEmptyObject(b)?a.prompt(z.upload_choose_file):b.submit()}),w.fileupload({autoUpload:!1,dataType:"json",url:j+"?config="+userconfig,paramName:g.upload.paramName}).on("fileuploadadd",function(a,b){x.data(b)}).on("fileuploadsubmit",function(a,b){b.formData={mode:"add",currentpath:ea()},x.addClass("loading").prop("disabled",!0),x.children("span").text(z.loading_data)}).on("fileuploadalways",function(b,c){a("#filepath").val(""),x.removeData().removeClass("loading").prop("disabled",!1),x.children("span").text(z.upload);var d,e=c.result;if(e.files&&e.files[0].error&&(d=e.files[0].error),"-1"==e.Code&&e.Error&&(d=e.Error),d)a.prompt(z.upload_failed+"<br>"+d);else{var f=ea();Na(f),Ia(f),g.options.showConfirmation&&a.prompt(z.upload_successful_file)}}).on("fileuploadfail",function(b,c){a.prompt(z.upload_failed)})),g.customScrollbar.enabled){q("/scripts/custom-scrollbar-plugin/jquery.mCustomScrollbar.min.css"),r("/scripts/custom-scrollbar-plugin/jquery.mCustomScrollbar.concat.min.js");var d=void 0!=g.customScrollbar.theme?g.customScrollbar.theme:"inset-2-dark",e=void 0==g.customScrollbar.button||g.customScrollbar.button;a(window).load(function(){v.append('<div style="height:3000px"></div>'),v.mCustomScrollbar({theme:d,scrollButtons:{enable:e},advanced:{autoExpandHorizontalScroll:!0,updateOnContentResize:!0},callbacks:{onInit:function(){ka()}},axis:"yx"}),u.mCustomScrollbar({theme:d,scrollButtons:{enable:e},advanced:{autoExpandHorizontalScroll:!0,updateOnContentResize:!0},axis:"y",alwaysShowScrollbar:1})})}else ka();1==g.options.browseOnly&&(a("#file-input-container").remove(),x.remove(),a("#newfolder").remove(),a("#toolbar").remove("#rename")),A(),a(window).resize(A),a("#splitter").splitter({sizeLeft:g.options.splitterMinWidth,minLeft:g.options.splitterMinWidth,minRight:200}),Ja(i+c)});var Ra=document.documentElement;if(Ra.setAttribute("data-useragent",navigator.userAgent),g.options.logger){(new Date).getTime()}a(window).load(function(){A()})}(jQuery),window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")),$(window).load(function(){$("#fileinfo").css({left:$("#splitter .vsplitbar").width()+$("#filetree").width()})});
